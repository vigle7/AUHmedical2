"use strict";
var core_1 = require("@angular/core");
var router_1 = require("@angular/router");
var page_1 = require("ui/page");
require("rxjs/add/operator/take");
var store_1 = require('@ngrx/store');
var user_1 = require("../../share/user");
var dialogs = require("ui/dialogs");
var view = require("ui/core/view");
var Toast = require("nativescript-toast");
var fetchModule = require("fetch");
var appSettings = require("application-settings");
var SignUpComponent = (function () {
    function SignUpComponent(router, page, store) {
        var _this = this;
        this.router = router;
        this.page = page;
        this.store = store;
        this.isDatePickerVisible = false;
        this.user = new user_1.User();
        this.store$ = this.store.select('dateData');
        this.store$.subscribe(function (s) { return _this.user.ambbgndt = s; });
    }
    SignUpComponent.prototype.ngOnInit = function () {
        // firebase.addOnPushTokenReceivedCallback(
        //   (tokenreal)=> {
        //     console.log(tokenreal);   
        //     this.token = tokenreal;
        //   }
        // )
        this.showLogin = true;
        var firstTextFieldId = this.page.getViewById("firstTextFieldId");
        firstTextFieldId.focus();
    };
    SignUpComponent.prototype.showDatePicker = function () {
        var textFielsBDate = this.page.getViewById("textFieldBDate");
        this.router.navigate(["/datePicker"]);
        setTimeout(function () {
            textFielsBDate.dismissSoftInput();
        }, 100);
    };
    SignUpComponent.prototype.signUp = function () {
        var _this = this;
        this.user.ambno = this.user.ambno.toUpperCase();
        if (!this.user.isTaiwanID()) {
            this.displayActionDialog("請輸入正確的身份證號碼格式");
            return;
        }
        if (!this.user.isValidEmail()) {
            this.displayActionDialog("請輸入有效的電子信箱");
            return;
        }
        if (this.user.ambno === "" || this.user.ambemail === "") {
            this.displayActionDialog("請輸入所有資料");
            return;
        }
        this.showLogin = false;
        this.token = global.loginResponse.tokenid;
        var parsedate = this.user.ambbgndt.toISOString().slice(0, 10).replace(/-/g, "");
        var taiwanDate = Number(parsedate) - 19110000;
        fetchModule.fetch("http://122.146.168.11/AppRegister/api/ApplyforReg/PushCloudNotifyNumber", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ ambno: this.user.ambno, ambbgndt: "0" + taiwanDate, asrtype: "D2", ambemail: this.user.ambemail, ambaddr: this.user.ambaddr, atktokenid: this.token })
        })
            .then(function (response) {
            appSettings.setString("tokenid", _this.token);
            _this.router.navigate(["/login"]);
            var toast = Toast.makeText("稍後寄出密碼通知");
            toast.show();
            _this.showLogin = true;
        }, function (error) {
            console.log(error);
        });
    };
    SignUpComponent.prototype.displayActionDialog = function (msg) {
        var options = {
            message: msg,
            okButtonText: "確定"
        };
        dialogs.alert(options);
    };
    SignUpComponent = __decorate([
        core_1.Component({
            selector: "signUp",
            templateUrl: "pages/signUp/signUp.html",
            styleUrls: ["pages/signUp/signUp.css"],
        }), 
        __metadata('design:paramtypes', [router_1.Router, page_1.Page, store_1.Store])
    ], SignUpComponent);
    return SignUpComponent;
}());
exports.SignUpComponent = SignUpComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lnblVwLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInNpZ25VcC5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHFCQUEwRCxlQUFlLENBQUMsQ0FBQTtBQUMxRSx1QkFBdUIsaUJBQWlCLENBQUMsQ0FBQTtBQUd6QyxxQkFBcUIsU0FBUyxDQUFDLENBQUE7QUFDL0IsUUFBTyx3QkFBd0IsQ0FBQyxDQUFBO0FBQ2hDLHNCQUFzQixhQUFhLENBQUMsQ0FBQTtBQUNwQyxxQkFBbUIsa0JBQ25CLENBQUMsQ0FEb0M7QUFDckMsSUFBWSxPQUFPLFdBQU0sWUFBWSxDQUFDLENBQUE7QUFFdEMsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0FBSXJDLElBQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0FBQzVDLElBQU0sV0FBVyxHQUFHLE9BQU8sQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUNyQyxJQUFNLFdBQVcsR0FBRyxPQUFPLENBQUMsc0JBQXNCLENBQUMsQ0FBQztBQVdwRDtJQVlJLHlCQUFvQixNQUFjLEVBQVMsSUFBVSxFQUFTLEtBQXNCO1FBWnhGLGlCQW9HQztRQXhGdUIsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQUFTLFNBQUksR0FBSixJQUFJLENBQU07UUFBUyxVQUFLLEdBQUwsS0FBSyxDQUFpQjtRQUg1RSx3QkFBbUIsR0FBVyxLQUFLLENBQUM7UUFLMUMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLFdBQUksRUFBRSxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxNQUFNLEdBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUM7UUFDN0MsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsVUFBQSxDQUFDLElBQUksT0FBQSxLQUFJLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLEVBQXRCLENBQXNCLENBQUMs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Q0FBQyxRQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQ2pDLElBQUksS0FBSyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLENBQUM7WUFDdkMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDO1lBQ2IsS0FBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUM7UUFDekIsQ0FBQyxFQUFFLFVBQUMsS0FBSztZQUNOLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdkIsQ0FBQyxDQUFDLENBQUM7SUFJVCxDQUFDO0lBRUEsNkNBQW1CLEdBQW5CLFVBQW9CLEdBQUc7UUFFcEIsSUFBSSxPQUFPLEdBQUc7WUFDVixPQUFPLEVBQUUsR0FBRztZQUNaLFlBQVksRUFBRSxJQUFJO1NBQ3JCLENBQUM7UUFDRixPQUFPLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO0lBQzNCLENBQUM7SUF4R1A7UUFBQyxnQkFBUyxDQUFDO1lBQ1QsUUFBUSxFQUFFLFFBQVE7WUFDbEIsV0FBVyxFQUFFLDBCQUEwQjtZQUN2QyxTQUFTLEVBQUUsQ0FBQyx5QkFBeUIsQ0FBQztTQUN2QyxDQUFDOzt1QkFBQTtJQXFHRixzQkFBQztBQUFELENBQUMsQUFwR0QsSUFvR0M7QUFwR1ksdUJBQWUsa0JBb0czQixDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBFbGVtZW50UmVmLCBPbkluaXQsIFZpZXdDaGlsZCAgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSBcIkBhbmd1bGFyL3JvdXRlclwiO1xuaW1wb3J0IHsgRGF0ZVBpY2tlciB9IGZyb20gXCJ1aS9kYXRlLXBpY2tlclwiO1xuaW1wb3J0IHsgVGV4dEZpZWxkIH0gZnJvbSBcInVpL3RleHQtZmllbGRcIjtcbmltcG9ydCB7IFBhZ2UgfSBmcm9tIFwidWkvcGFnZVwiO1xuaW1wb3J0IFwicnhqcy9hZGQvb3BlcmF0b3IvdGFrZVwiO1xuaW1wb3J0IHsgU3RvcmUgfSBmcm9tICdAbmdyeC9zdG9yZSc7XG5pbXBvcnQge1VzZXJ9IGZyb20gXCIuLi8uLi9zaGFyZS91c2VyXCJcbmltcG9ydCAqIGFzIGRpYWxvZ3MgZnJvbSBcInVpL2RpYWxvZ3NcIjtcbmltcG9ydCB7T2JzZXJ2YWJsZX0gZnJvbSAncnhqcy9SeCc7XG5jb25zdCB2aWV3ID0gcmVxdWlyZShcInVpL2NvcmUvdmlld1wiKTtcbmltcG9ydCBhY3Rpdml0eUluZGljYXRvck1vZHVsZSA9IHJlcXVpcmUoXCJ1aS9hY3Rpdml0eS1pbmRpY2F0b3JcIik7XG5cbmltcG9ydCBmaXJlYmFzZSA9IHJlcXVpcmUoXCJuYXRpdmVzY3JpcHQtcGx1Z2luLWZpcmViYXNlXCIpO1xuY29uc3QgVG9hc3QgPSByZXF1aXJlKFwibmF0aXZlc2NyaXB0LXRvYXN0XCIpO1xuY29uc3QgZmV0Y2hNb2R1bGUgPSByZXF1aXJlKFwiZmV0Y2hcIik7XG5jb25zdCBhcHBTZXR0aW5ncyA9IHJlcXVpcmUoXCJhcHBsaWNhdGlvbi1zZXR0aW5nc1wiKTtcblxuaW50ZXJmYWNlIEFwcFN0YXRlIHtcbiBzdGF0ZSA6IERhdGVcbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiBcInNpZ25VcFwiLFxuICB0ZW1wbGF0ZVVybDogXCJwYWdlcy9zaWduVXAvc2lnblVwLmh0bWxcIixcbiAgc3R5bGVVcmxzOiBbXCJwYWdlcy9zaWduVXAvc2lnblVwLmNzc1wiXSxcbn0pXG5leHBvcnQgY2xhc3MgU2lnblVwQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcblxuICAgIHByaXZhdGUgc3RvcmUkOiBPYnNlcnZhYmxlPERhdGU+O1xuXG4gICAgcHJpdmF0ZSB1c2VyOlVzZXI7XG5cbiAgICBwcml2YXRlIHRva2VuOmFueTtcbiAgICBwcml2YXRlIHNob3dMb2dpbjpib29sZWFuO1xuXG4gICAgcHJpdmF0ZSBpc0RhdGVQaWNrZXJWaXNpYmxlOmJvb2xlYW4gPSBmYWxzZTtcblxuXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSByb3V0ZXI6IFJvdXRlcixwcml2YXRlIHBhZ2U6IFBhZ2UscHJpdmF0ZSBzdG9yZTogU3RvcmU8QXBwU3RhdGU+KSB7XG5cbiAgICAgIHRoaXMudXNlciA9IG5ldyBVc2VyKCk7XG4gICAgICB0aGlzLnN0b3JlJCA9ICB0aGlzLnN0b3JlLnNlbGVjdCgnZGF0ZURhdGEnKTtcbiAgICAgIHRoaXMuc3RvcmUkLnN1YnNjcmliZShzID0+IHRoaXMudXNlci5hbWJiZ25kdCA9IHMpO1xuXG5cblxuICAgIH1cblxuICAgICAgbmdPbkluaXQoKSB7XG5cbiAgICAgICAgLy8gZmlyZWJhc2UuYWRkT25QdXNoVG9rZW5SZWNlaXZlZENhbGxiYWNrKFxuICAgICAgICAvLyAgICh0b2tlbnJlYWwpPT4ge1xuICAgICAgICAvLyAgICAgY29uc29sZS5sb2codG9rZW5yZWFsKTsgICBcbiAgICAgICAgLy8gICAgIHRoaXMudG9rZW4gPSB0b2tlbnJlYWw7XG4gICAgICAgIC8vICAgfVxuICAgICAgICAvLyApXG5cbiAgIFxuICAgICAgICAgIHRoaXMuc2hvd0xvZ2luID0gdHJ1ZTtcblxuICAgICAgICAgIGxldCBmaXJzdFRleHRGaWVsZElkID0gdGhpcy5wYWdlLmdldFZpZXdCeUlkPFRleHRGaWVsZD4oXCJmaXJzdFRleHRGaWVsZElkXCIpO1xuICAgICAgICAgICAgICBmaXJzdFRleHRGaWVsZElkLmZvY3VzKCk7XG4gICAgICB9XG5cblxuXG5cbiAgICAgIHNob3dEYXRlUGlja2VyKCkge1xuICAgICAgICAgIGxldCB0ZXh0RmllbHNCRGF0ZSA9IHRoaXMucGFnZS5nZXRWaWV3QnlJZDxUZXh0RmllbGQ+KFwidGV4dEZpZWxkQkRhdGVcIik7XG4gICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoW1wiL2RhdGVQaWNrZXJcIl0pO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgdGV4dEZpZWxzQkRhdGUuZGlzbWlzc1NvZnRJbnB1dCgpO1xuICAgICAgICB9LCAxMDApO1xuXG4gICAgICB9XG5cbiAgICAgIHNpZ25VcCgpe1xuICAgICAgICAgIHRoaXMudXNlci5hbWJubyA9IHRoaXMudXNlci5hbWJuby50b1VwcGVyQ2FzZSgpXG4gICAgICAgICAgaWYoIXRoaXMudXNlci5pc1RhaXdhbklEKCkpe1xuICAgICAgICAgICAgICB0aGlzLmRpc3BsYXlBY3Rpb25EaWFsb2coXCLoq4vovLjlhaXmraPnorrnmoTouqvku73orYnomZ/norzmoLzlvI9cIik7XG4gICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmICghdGhpcy51c2VyLmlzVmFsaWRFbWFpbCgpKSB7XG4gICAgICAgICAgICB0aGlzLmRpc3BsYXlBY3Rpb25EaWFsb2coXCLoq4vovLjlhaXmnInmlYjnmoTpm7vlrZDkv6HnrrFcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYodGhpcy51c2VyLmFtYm5vPT09XCJcIiB8fCB0aGlzLnVzZXIuYW1iZW1haWw9PT1cIlwiICl7XG4gICAgICAgICAgICAgIHRoaXMuZGlzcGxheUFjdGlvbkRpYWxvZyhcIuiri+i8uOWFpeaJgOacieizh+aWmVwiKTtcbiAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5zaG93TG9naW4gPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLnRva2VuID0gIGdsb2JhbC5sb2dpblJlc3BvbnNlLnRva2VuaWQ7XG5cbiAgICAgICAgICBsZXQgcGFyc2VkYXRlID0gdGhpcy51c2VyLmFtYmJnbmR0LnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwxMCkucmVwbGFjZSgvLS9nLFwiXCIpO1xuICAgICAgICAgIGxldCB0YWl3YW5EYXRlID0gTnVtYmVyKHBhcnNlZGF0ZSkgLTE5MTEwMDAwO1xuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgZmV0Y2hNb2R1bGUuZmV0Y2goXCJodHRwOi8vMTIyLjE0Ni4xNjguMTEvQXBwUmVnaXN0ZXIvYXBpL0FwcGx5Zm9yUmVnL1B1c2hDbG91ZE5vdGlmeU51bWJlclwiLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7IFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe2FtYm5vOiB0aGlzLnVzZXIuYW1ibm8sIGFtYmJnbmR0OiBcIjBcIit0YWl3YW5EYXRlLCBhc3J0eXBlOiBcIkQyXCIsYW1iZW1haWw6IHRoaXMudXNlci5hbWJlbWFpbCwgYW1iYWRkcjogdGhpcy51c2VyLmFtYmFkZHIsYXRrdG9rZW5pZDogdGhpcy50b2tlbn0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnRoZW4oKHJlc3BvbnNlKT0+IHtcbiAgICAgICAgICAgICAgICBhcHBTZXR0aW5ncy5zZXRTdHJpbmcoXCJ0b2tlbmlkXCIsIHRoaXMudG9rZW4pO1xuICAgICAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFtcIi9sb2dpblwiXSk7XG4gICAgICAgICAgICAgICAgbGV0IHRvYXN0ID0gVG9hc3QubWFrZVRleHQoXCLnqI3lvozlr4Tlh7rlr4bnorzpgJrnn6VcIik7XG4gICAgICAgICAgICAgICAgdG9hc3Quc2hvdygpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0xvZ2luID0gdHJ1ZTtcbiAgICAgICAgICAgICB9LCAoZXJyb3IpID0+e1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuXG5cblxuICAgICAgfVxuXG4gICAgICAgZGlzcGxheUFjdGlvbkRpYWxvZyhtc2cpIHtcblxuICAgICAgICAgIGxldCBvcHRpb25zID0geyBcbiAgICAgICAgICAgICAgbWVzc2FnZTogbXNnLFxuICAgICAgICAgICAgICBva0J1dHRvblRleHQ6IFwi56K65a6aXCJcbiAgICAgICAgICB9O1xuICAgICAgICAgIGRpYWxvZ3MuYWxlcnQob3B0aW9ucyk7XG4gICAgICB9ICBcbn1cblxuIl19